{"version":2,"name":"teamneko","disableSend":false,"placeBeforeInput":false,"injectInput":false,"color":"rgba(0, 0, 0, 0)","onlyBorderColor":false,"qrList":[{"id":1,"showLabel":false,"label":"init","title":"","message":"/echo Initializing |\n\n/run varname=lvl creamsan.isvardefined |\n/if left={{pipe}} right=false rule=eq {: /setvar key=lvl 0 :} |\n\n/if left=lvl right=0 rule=gt {: /abort :} |\n\n/buttons labels=[\"Normal\",\"Hard\"] Select difficulty |\n/if left={{pipe}} right=Normal rule=eq else={: /setvar key=hardmode true :} {: /setvar key=hardmode false :} |\n\n/if left=hardmode right=true rule=eq else={:\n  /setvar key=linescale 2 | /setvar key=hp 5\n:}\n{:\n  /setvar key=linescale 0.2 | /setvar key=hp 3\n:} |\n\n/setvar key=lvl 0 |\n/setvar key=cooldown 2 |\n/setvar key=angle 0 |\n/setvar key=mapw 500 |\n/setvar key=maph 400 | /setvar key=line |\n/setvar key=encounter false |\n\n/setvar key=tanksmoke https://creamsan.neocities.org/files/assets/tanksmoke.gif |\n\n/setvar key=i 0 |\n/times 4 {:\n  /addvar key=i 1 |\n  /setvar key=\"tank{{getvar::i}}\" https://creamsan.neocities.org/files/assets/tank{{getvar::i}}.png |\n  /setvar key=\"tank{{getvar::i}}gun\" https://creamsan.neocities.org/files/assets/tank{{getvar::i}}gun.png |\n  /setvar key=\"enemy{{getvar::i}}smoke\" hidden |\n  /setvar key=\"enemy{{getvar::i}}tank\" hidden\n:} |\n\n/setvar key=tank1gunxoffset 13 |\n/setvar key=tank1gunyoffset 41 |\n/setvar key=tank1xoffset 18 |\n/setvar key=tank1yoffset 30 |\n\n/setvar key=tank2gunxoffset 13 |\n/setvar key=tank2gunyoffset 25 |\n/setvar key=tank2xoffset 18 |\n/setvar key=tank2yoffset 33 |\n\n/setvar key=tank3gunxoffset 13 |\n/setvar key=tank3gunyoffset 40 |\n/setvar key=tank3xoffset 18 |\n/setvar key=tank3yoffset 33 |\n\n/setvar key=tank4gunxoffset 13 |\n/setvar key=tank4gunyoffset 55 |\n/setvar key=tank4xoffset 18 |\n/setvar key=tank4yoffset 33 |\n\n/setvar key=tanksmokexoffset 100 |\n/setvar key=tanksmokeyoffset 180 |\n\n/setvar index=1 key=chancesnormal 4 |\n/setvar index=2 key=chancesnormal 3 |\n/setvar index=3 key=chancesnormal 8 |\n/setvar index=4 key=chancesnormal 6 |\n/setvar index=5 key=chancesnormal 12 |\n/setvar index=6 key=chancesnormal 9 |\n/setvar index=7 key=chancesnormal 12 |\n/setvar index=8 key=chancesnormal 8 |\n\n/setvar index=1 key=chanceshard 3 |\n/setvar index=2 key=chanceshard 2 |\n/setvar index=3 key=chanceshard 6 |\n/setvar index=4 key=chanceshard 4 |\n/setvar index=5 key=chanceshard 9 |\n/setvar index=6 key=chanceshard 6 |\n/setvar index=7 key=chanceshard 8 |\n/setvar index=8 key=chanceshard 6 |\n\n/setvar index=1 key=lvlenemycount 1 |\n/setvar index=2 key=lvlenemycount 1 |\n/setvar index=3 key=lvlenemycount 2 |\n/setvar index=4 key=lvlenemycount 2 |\n/setvar index=5 key=lvlenemycount 3 |\n/setvar index=6 key=lvlenemycount 3 |\n/setvar index=7 key=lvlenemycount 4 |\n/setvar index=8 key=lvlenemycount 4 |\n\n/setvar key=distances index=0 200 |\n/setvar key=distances index=1 250 |\n/setvar key=distances index=2 300 |\n/setvar key=distances index=3 350 |\n/setvar key=distances index=4 385 |\n\n/setvar key=200 index=maxangle 85 |\n/setvar key=200 index=precision 4 |\n/setvar key=200 index=maxspeed 10 |\n\n/setvar key=250 index=maxangle 50 |\n/setvar key=250 index=precision 3 |\n/setvar key=250 index=maxspeed 5 |\n\n/setvar key=300 index=maxangle 40 |\n/setvar key=300 index=precision 2 |\n/setvar key=300 index=maxspeed 5 |\n\n/setvar key=350 index=maxangle 30 |\n/setvar key=350 index=precision 2 |\n/setvar key=350 index=maxspeed 2 |\n\n/setvar key=385 index=maxangle 25 |\n/setvar key=385 index=precision 1 |\n/setvar key=385 index=maxspeed 2","contextList":[],"preventAutoExecute":true,"isHidden":true,"executeOnStartup":false,"executeOnUser":false,"executeOnAi":false,"executeOnChatChange":false,"executeOnGroupMemberDraft":false,"executeOnNewChat":false,"automationId":""},{"id":3,"showLabel":false,"label":"userprocess","title":"","message":"/setvar key=userinput {{input}} |\n\n/if left=hp right=0 rule=lte {:\n  /setvar key=jbout - | /echo It's over. Use the normal Send button. | /abort\n:} |\n\n/if left=lvl right=8 rule=gte {:\n  /setvar key=jbout - | /echo It's over. Use the normal Send button. | /abort\n:} |\n\n\n/let scanenemies {:\n\t/setvar key=i 0 |\n\t/times {{getvar::enemycount}} {: /run {{getvar::enemyprocess}} :}\n:} |\n\n/let resetenemy {:\n\t/addvar key=i 1 |\n\t/setvar key=\"enemy{{getvar::i}}smoke\" hidden |\n\t/setvar key=\"enemy{{getvar::i}}tank\" hidden\n:} |\n\n/let genenemy {:\n\t/getvar index={{getvar::i}} arr |\n\t/setvar key=dist | /setvar key=distkey {{pipe}} |\n\t\n\t/addvar key=i 1 |\n\t/setvar key=\"enemy{{getvar::i}}dist\" {{getvar::dist}} |\n\t\n\t/getvar index=maxangle {{getvar::distkey}} |\n\t/setvar key=minmax |\n\t/rand from=\"-{{getvar::minmax}}\" to={{getvar::minmax}} round=round |\n\t/setvar key=\"enemy{{getvar::i}}currangle\" |\n\t\n\t/getvar index=maxspeed {{getvar::distkey}} |\n\t/setvar key=minmax |\n\t/rand from=\"-{{getvar::minmax}}\" to={{getvar::minmax}} round=round |\n\t/setvar key=\"enemy{{getvar::i}}speed\" |\n\t\n\t/setvar key=\"enemy{{getvar::i}}tank\" visible\n:} |\n\n/let genenemies {:\n\t/if left=lvl right=8 rule=gte {: /break :} |\n\n\t/addvar key=lvl 1 |\n\t/setvar key=enemyprocess resetenemy |\n\t/run scanenemies |\n\t/setvar key=arr {{getvar::distances}} |\n\t/run creamsan.shuffle |\n\t\n\t/getvar index={{getvar::lvl}} lvlenemycount |\n\t/setvar key=enemycount | /setvar key=enemyremaining |\n\t/setvar key=enemyprocess genenemy |\n\t/run scanenemies |\n\t\n\t/setvar key=jbout Enemy spotted. Number of enemies: {{getvar::enemycount}}. Prepare for battle. Include the following codeblock in the response: ```\nBEGIN BATTLE\n``` |\n\t\n\t/if left=hardmode right=true rule=eq else={:\n\t  /getvar index={{getvar::lvl}} chancesnormal |\n\t  /setvar key=chances\n\t:}\n\t{:\n\t  /getvar index={{getvar::lvl}} chanceshard |\n\t  /setvar key=chances\n\t:}\n:} |\n\n\n/setvar key=log Event log: |\n/setvar key=jbout No enemies for now. |\n/if left=cooldown right=0 rule=lte {: /run genenemies :} |\n/addvar key=cooldown -1 |\n\n/run teamneko.detectencounter |\n/if left=encounter right=true rule=eq {:\n  /run teamneko.aimloop |\n  /setvar key=cooldown {{random: 0,1}} |\n  /setvar key=encounter false\n:} |\n\n/flushvar nadanada","contextList":[],"preventAutoExecute":true,"isHidden":true,"executeOnStartup":false,"executeOnUser":false,"executeOnAi":false,"executeOnChatChange":false,"executeOnGroupMemberDraft":false,"executeOnNewChat":false,"automationId":""},{"id":5,"showLabel":false,"label":"aiprocess","title":"","message":"/if left={{lastMessageId}} right=0 rule=eq {: /abort :}","contextList":[],"preventAutoExecute":true,"isHidden":true,"executeOnStartup":false,"executeOnUser":false,"executeOnAi":true,"executeOnChatChange":false,"executeOnGroupMemberDraft":false,"executeOnNewChat":false,"automationId":""},{"id":7,"showLabel":false,"label":"Send","title":"","message":"/run teamneko.userprocess |\n/send {{getvar::userinput}}\n{{pipe}} |\n/trigger || /setinput","contextList":[],"preventAutoExecute":true,"isHidden":false,"executeOnStartup":false,"executeOnUser":false,"executeOnAi":false,"executeOnChatChange":false,"executeOnGroupMemberDraft":false,"executeOnNewChat":false,"automationId":""},{"id":11,"showLabel":false,"label":"aimloop","title":"","message":"/let scanenemies {:\n\t/setvar key=i 0 |\n\t/times {{getvar::enemycount}} {: /run {{getvar::enemyprocess}} :}\n:} |\n\n\n/let moveenemy {:\n\t/setvar key=toreverse false |\n\t/addvar key=i 1 |\n\t\n\t/pass enemy{{getvar::i}}speed |\n\t/getvar {{pipe}} |\n\t/setvar key=enemyspeed |\n\t\n\t/pass enemy{{getvar::i}}dist |\n\t/getvar {{pipe}} | /pass {{pipe}} |\n\t/getvar index=maxangle {{pipe}} |\n\t/setvar key=maxangle |\n\t\n\t/pass enemy{{getvar::i}}currangle |\n\t/getvar {{pipe}} |\n\t/setvar key=enemyangle |\n\t/add enemyangle enemyspeed | /setvar key=newangle |\n\t/if left=newangle right=\"-{{getvar::maxangle}}\" rule=lt {: /setvar key=toreverse true :} |\n\t/if left=newangle right=maxangle rule=gt {: /setvar key=toreverse true :} |\n\t/if left=toreverse right=true rule=eq {:\n\t  /mul -1 enemyspeed |\n\t  /setvar key=\"enemy{{getvar::i}}speed\" |\n\t  /setvar key=enemyspeed |\n\t  /add {{pipe}} enemyangle |\n\t  /setvar key=newangle\n\t:} |\n\t\n\t/pass enemy{{getvar::i}}smoke |\n\t/if left={{pipe}} right=hidden rule=eq {:\n\t  /setvar key=\"enemy{{getvar::i}}currangle\" {{getvar::newangle}}\n\t:}\n:} |\n\n\n/let hitenemy {:\n\t/setvar key=ishit true |\n\t/addvar key=i 1 |\n\t\n\t/pass enemy{{getvar::i}}currangle |\n\t/getvar {{pipe}} | /setvar key=enemyangle |\n\t\n\t/pass enemy{{getvar::i}}dist |\n\t/getvar {{pipe}} | /pass {{pipe}} |\n\t/getvar index=precision {{pipe}} | /setvar key=precision |\n\t/mul -1 precision | /add {{pipe}} enemyangle |\n\t/setvar key=minanglehit |\n\t/add precision enemyangle |\n\t/setvar key=maxanglehit |\n\t\n\t/if left=angle right=minanglehit rule=lt {: /setvar key=ishit false :} |\n\t/if left=angle right=maxanglehit rule=gt {: /setvar key=ishit false :} |\n\t/if left=ishit right=false rule=eq {: /break :} |\n\t\n\t/pass enemy{{getvar::i}}smoke |\n\t/if left={{pipe}} right=hidden rule=eq {:\n\t  /setvar key=\"enemy{{getvar::i}}smoke\" visible |\n\t  /setvar key=\"enemy{{getvar::i}}speed\" 0 |\n\t  /addvar key=enemyremaining -1 |\n\t  /addvar key=hitsinarow 1 |\n\t  /echo Nice shot!\n\t:} |\n\t\n\t/if left=hitsinarow right=1 rule=gt {: /setvar key=log {{getvar::log}}{{newline}}- With her luck and skill, {{user}}-chan took out {{getvar::hitsinarow}} tanks in a row with a single shot.\n- Crewmates praise {{user}}-chan.\n- This makes Miki wet her panties.\n- Emi hugs {{user}}-chan in excitement while fondling her boobs and stroking her thighs.\n- Ayame blushes. She keeps stealing glances. :} |\n\t\n\t/if left=enemyremaining right=0 rule=lte {: /run teamneko.winbattle :}\n:} |\n\n\n/let validateaiminput {:\n\t/setvar key=validaiminput true |\n\t\t\n\t/re-replace find=/[^a-z\\d\\-]/gi replace={{noop}} {{getvar::tempangle}} |\n\t/setvar key=tempangle |\n\t\n\t/if left=tempangle right=surrender rule=eq {:\n\t  /setvar key=angle 0 | /setvar key=hp 0\n\t:} |\n\t\n\t/if left=chances right=0 rule=lte {: /run teamneko.rolltakedmg :} |\n\t\n\t/if left=hp right=0 rule=lte {:\n\t  /echo severity=error Your team is eliminated. Game over. |\n\t  /setvar key=looping false |\n\t  /run teamneko.gameover |\n\t  /break\n\t:} |\n\t\n\t/if left=tempangle right=fire rule=eq {:\n\t  /setvar key=enemyprocess hitenemy |\n\t  /setvar key=hitsinarow 0 |\n\t  /run scanenemies\n\t:} |\n\t\n\t/re-replace find=/[^\\d\\-]/gi replace={{noop}} {{getvar::tempangle}} | /setvar key=tempangle |\n\t\n\t/run varname=tempangle creamsan.isvardefined |\n\t/if left={{pipe}} right=false rule=eq {: /setvar key=validaiminput false :} |\n\t\n\t/if left=validaiminput right=true rule=eq {: /setvar key=angle {{getvar::tempangle}} :} |\n\t\n\t/addvar key=chances -1 |\n\t/max 0 chances | /setvar key=chances |\n\t\n\t/setvar key=enemyprocess moveenemy |\n\t/run scanenemies\n:} |\n\n\n/setvar key=looping true |\n/setvar key=tempangle 0 |\n/setvar key=bg {{random: https://c.tenor.com/0e6lbNV-AEYAAAAd/tenor.gif,\nhttps://opengameart.org/sites/default/files/backgrounddetailed1.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed2.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed3.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed5.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed6.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed7.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed8.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed1.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed2.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed3.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed5.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed6.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed7.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed8.png}} |\n\n\n/while left=looping right=true rule=eq {:\n\t/run teamneko.gethpdisp |\n\n\t/input <div style='display: flex; gap: 3px; flex-direction: column; justify-content: center; padding: 5px'>\n\t<style>\n\t.mapscreen {max-width: {{getvar::mapw}}px;\n\theight: {{getvar::maph}}px;\n\tborder: 1px solid green;\n\tposition: relative;\n\toverflow: hidden;\n\tbackground-image: url('{{getvar::bg}}');\n\tbackground-position: bottom\n\t}\n\t.aimline {border-right: 2px solid red;\n\twidth: 2px;\n\theight: {{getvar::line}}px;\n\ttransform-origin: 50% 100%;\n\tposition: absolute;\n\tleft: 50%;\n\ttransform: rotate({{getvar::angle}}deg) scaleY({{getvar::linescale}})\n\t}\n\t.tank {box-shadow: 10px 5px 10px 2px rgba(0, 0, 0, 0.5)\n\t}\n\t.playertank {transform-origin: {{getvar::tank1xoffset}}px {{getvar::tank1yoffset}}px;\n\ttransform: translateX(-{{getvar::tank1xoffset}}px) translateY(-{{getvar::tank1yoffset}}px) scale(0.5)\n\t}\n\t.playergun {transform-origin: {{getvar::tank1gunxoffset}}px {{getvar::tank1gunyoffset}}px;\n\ttransform: translateX(-{{getvar::tank1gunxoffset}}px) translateY(-{{getvar::tank1gunyoffset}}px) scale(0.6) rotate({{getvar::angle}}deg)\n\t}\n\t.playerpos {position: absolute;\n\ttop: 99.5%;\n\tleft: 50%\n\t}\n\t\n\t.enemytank1 {transform-origin: {{getvar::tank1xoffset}}px {{getvar::tank1yoffset}}px;\n\ttransform: translateX(-{{getvar::tank1xoffset}}px) translateY(-{{getvar::tank1yoffset}}px) scale(0.5) rotate(90deg);\n\tposition: absolute\n\t}\n\t.enemygun1 {transform-origin: {{getvar::tank1gunxoffset}}px {{getvar::tank1gunyoffset}}px;\n\ttransform: translateX(-{{getvar::tank1gunxoffset}}px) translateY(-{{getvar::tank1gunyoffset}}px) scale(0.5) rotate(180deg);\n\tposition: absolute\n\t}\n\t.enemy1 {position: absolute;\n\ttop: 100%;\n\tleft: 50%;\n\ttransform: rotate({{getvar::enemy1currangle}}deg) translateY(-{{getvar::enemy1dist}}px);\n\tvisibility: {{getvar::enemy1tank}}\n\t}\n\t.tank1smoke {transform-origin: {{getvar::tanksmokexoffset}}px {{getvar::tanksmokeyoffset}}px;\n\ttransform: translateX(-{{getvar::tanksmokexoffset}}px) translateY(-{{getvar::tanksmokeyoffset}}px) scaleX(0.4) scaleY(0.3) rotate(calc(-1 * {{getvar::enemy1currangle}}deg));\n\tposition: absolute;\n\tvisibility: {{getvar::enemy1smoke}}\n\t}\n\t\n\t.enemytank2 {transform-origin: {{getvar::tank2xoffset}}px {{getvar::tank2yoffset}}px;\n\ttransform: translateX(-{{getvar::tank2xoffset}}px) translateY(-{{getvar::tank2yoffset}}px) scale(0.5) rotate(90deg);\n\tposition: absolute\n\t}\n\t.enemygun2 {transform-origin: {{getvar::tank2gunxoffset}}px {{getvar::tank2gunyoffset}}px;\n\ttransform: translateX(-{{getvar::tank2gunxoffset}}px) translateY(-{{getvar::tank2gunyoffset}}px) scale(0.5) rotate(180deg);\n\tposition: absolute\n\t}\n\t.enemy2 {position: absolute;\n\ttop: 100%;\n\tleft: 50%;\n\ttransform: rotate({{getvar::enemy2currangle}}deg) translateY(-{{getvar::enemy2dist}}px);\n\tvisibility: {{getvar::enemy2tank}}\n\t}\n\t.tank2smoke {transform-origin: {{getvar::tanksmokexoffset}}px {{getvar::tanksmokeyoffset}}px;\n\ttransform: translateX(-{{getvar::tanksmokexoffset}}px) translateY(-{{getvar::tanksmokeyoffset}}px) scaleX(0.4) scaleY(0.3) rotate(calc(-1 * {{getvar::enemy2currangle}}deg));\n\tposition: absolute;\n\tvisibility: {{getvar::enemy2smoke}}\n\t}\n\t\n\t.enemytank3 {transform-origin: {{getvar::tank3xoffset}}px {{getvar::tank3yoffset}}px;\n\ttransform: translateX(-{{getvar::tank3xoffset}}px) translateY(-{{getvar::tank3yoffset}}px) scale(0.5) rotate(90deg);\n\tposition: absolute\n\t}\n\t.enemygun3 {transform-origin: {{getvar::tank3gunxoffset}}px {{getvar::tank3gunyoffset}}px;\n\ttransform: translateX(-{{getvar::tank3gunxoffset}}px) translateY(-{{getvar::tank3gunyoffset}}px) scale(0.5) rotate(180deg);\n\tposition: absolute\n\t}\n\t.enemy3 {position: absolute;\n\ttop: 100%;\n\tleft: 50%;\n\ttransform: rotate({{getvar::enemy3currangle}}deg) translateY(-{{getvar::enemy3dist}}px);\n\tvisibility: {{getvar::enemy3tank}}\n\t}\n\t.tank3smoke {transform-origin: {{getvar::tanksmokexoffset}}px {{getvar::tanksmokeyoffset}}px;\n\ttransform: translateX(-{{getvar::tanksmokexoffset}}px) translateY(-{{getvar::tanksmokeyoffset}}px) scaleX(0.4) scaleY(0.3) rotate(calc(-1 * {{getvar::enemy3currangle}}deg));\n\tposition: absolute;\n\tvisibility: {{getvar::enemy3smoke}}\n\t}\n\t\n\t.enemytank4 {transform-origin: {{getvar::tank4xoffset}}px {{getvar::tank4yoffset}}px;\n\ttransform: translateX(-{{getvar::tank4xoffset}}px) translateY(-{{getvar::tank4yoffset}}px) scale(0.5) rotate(90deg);\n\tposition: absolute\n\t}\n\t.enemygun4 {transform-origin: {{getvar::tank4gunxoffset}}px {{getvar::tank4gunyoffset}}px;\n\ttransform: translateX(-{{getvar::tank4gunxoffset}}px) translateY(-{{getvar::tank4gunyoffset}}px) scale(0.5) rotate(180deg);\n\tposition: absolute\n\t}\n\t.enemy4 {position: absolute;\n\ttop: 100%;\n\tleft: 50%;\n\ttransform: rotate({{getvar::enemy4currangle}}deg) translateY(-{{getvar::enemy4dist}}px);\n\tvisibility: {{getvar::enemy4tank}}\n\t}\n\t.tank4smoke {transform-origin: {{getvar::tanksmokexoffset}}px {{getvar::tanksmokeyoffset}}px;\n\ttransform: translateX(-{{getvar::tanksmokexoffset}}px) translateY(-{{getvar::tanksmokeyoffset}}px) scaleX(0.4) scaleY(0.3) rotate(calc(-1 * {{getvar::enemy4currangle}}deg));\n\tposition: absolute;\n\tvisibility: {{getvar::enemy4smoke}}\n\t}\n\t\n\t.info {padding: 3px;\n\ttext-align: left\n\t}\n\t.instruct {width: 70%;\n\tfont-size: 10px;\n\tborder: 1px solid green\n\t}\n\t.hud {width: 30%;\n\tborder: 1px solid red\n\t}\n\t</style>\n\t<div class='mapscreen'>\n\t\n\t<div class='aimline'></div>\n\t\n\t<img class='tank playertank playerpos' src='{{getvar::tank1}}' alt='Img loading failed :('>\n\t<img class='playergun playerpos' src='{{getvar::tank1gun}}' alt='Img loading failed :('>\n\t\n\t<div class='enemy1'>\n\t<img class='tank enemytank1' src='{{getvar::tank1}}' alt='Img loading failed :('>\n\t<img class='enemygun1' src='{{getvar::tank1gun}}' alt='Img loading failed :('>\n\t<img class='tank1smoke' src='{{getvar::tanksmoke}}' alt='Img loading failed :('>\n\t</div>\n\t\n\t<div class='enemy2'>\n\t<img class='tank enemytank2' src='{{getvar::tank2}}' alt='Img loading failed :('>\n\t<img class='enemygun2' src='{{getvar::tank2gun}}' alt='Img loading failed :('>\n\t<img class='tank2smoke' src='{{getvar::tanksmoke}}' alt='Img loading failed :('>\n\t</div>\n\t\n\t<div class='enemy3'>\n\t<img class='tank enemytank3' src='{{getvar::tank3}}' alt='Img loading failed :('>\n\t<img class='enemygun3' src='{{getvar::tank3gun}}' alt='Img loading failed :('>\n\t<img class='tank3smoke' src='{{getvar::tanksmoke}}' alt='Img loading failed :('>\n\t</div>\n\t\n\t<div class='enemy4'>\n\t<img class='tank enemytank4' src='{{getvar::tank4}}' alt='Img loading failed :('>\n\t<img class='enemygun4' src='{{getvar::tank4gun}}' alt='Img loading failed :('>\n\t<img class='tank4smoke' src='{{getvar::tanksmoke}}' alt='Img loading failed :('>\n\t</div>\n\t</div>\n\t\n\t<div style='display:flex; gap: 3px'>\n\t<div class='info instruct'>\n\tEnter the <b>angle</b> to aim. (0 means aim straight, negative values aim left, positive values aim right)<br>\n\tOnce you have targeted an enemy, enter <b>fire</b> to shoot.<br>\n\tEnter <font color=red><b>surrender</b></font> to lose and end the game.\n\t</div>\n\t<div class='info hud'>\n\tCurrent angle: {{getvar::angle}}°<br>\n\tHP: {{getvar::hpdisp}}<br>\n\tFree turns: {{getvar::chances}}\n\t</div>\n\t</div>\n\t</div> |\n\t\n\t/setvar key=tempangle |\n\t/run validateaiminput\n:}","contextList":[],"preventAutoExecute":true,"isHidden":true,"executeOnStartup":false,"executeOnUser":false,"executeOnAi":false,"executeOnChatChange":false,"executeOnGroupMemberDraft":false,"executeOnNewChat":false,"automationId":""},{"id":42,"showLabel":false,"label":"-- aimloop","title":"","message":"//legacy - this one uses the regex script |\n\n/let scanenemies {:\n\t/setvar key=i 0 |\n\t/times {{getvar::enemycount}} {: /run {{getvar::enemyprocess}} :}\n:} |\n\n\n/let moveenemy {:\n\t/setvar key=toreverse false |\n\t/addvar key=i 1 |\n\t\n\t/pass enemy{{getvar::i}}speed |\n\t/getvar {{pipe}} |\n\t/setvar key=enemyspeed |\n\t\n\t/pass enemy{{getvar::i}}dist |\n\t/getvar {{pipe}} | /pass {{pipe}} |\n\t/getvar index=maxangle {{pipe}} |\n\t/setvar key=maxangle |\n\t\n\t/pass enemy{{getvar::i}}currangle |\n\t/getvar {{pipe}} |\n\t/setvar key=enemyangle |\n\t/add enemyangle enemyspeed | /setvar key=newangle |\n\t/if left=newangle right=\"-{{getvar::maxangle}}\" rule=lt {: /setvar key=toreverse true :} |\n\t/if left=newangle right=maxangle rule=gt {: /setvar key=toreverse true :} |\n\t/if left=toreverse right=true rule=eq {:\n\t  /mul -1 enemyspeed |\n\t  /setvar key=\"enemy{{getvar::i}}speed\" |\n\t  /setvar key=enemyspeed |\n\t  /add {{pipe}} enemyangle |\n\t  /setvar key=newangle\n\t:} |\n\t\n\t/pass enemy{{getvar::i}}smoke |\n\t/if left={{pipe}} right=hidden rule=eq {:\n\t  /setvar key=\"enemy{{getvar::i}}currangle\" {{getvar::newangle}}\n\t:}\n:} |\n\n\n/let hitenemy {:\n\t/setvar key=ishit true |\n\t/addvar key=i 1 |\n\t\n\t/pass enemy{{getvar::i}}currangle |\n\t/getvar {{pipe}} | /setvar key=enemyangle |\n\t\n\t/pass enemy{{getvar::i}}dist |\n\t/getvar {{pipe}} | /pass {{pipe}} |\n\t/getvar index=precision {{pipe}} | /setvar key=precision |\n\t/mul -1 precision | /add {{pipe}} enemyangle |\n\t/setvar key=minanglehit |\n\t/add precision enemyangle |\n\t/setvar key=maxanglehit |\n\t\n\t/if left=angle right=minanglehit rule=lt {: /setvar key=ishit false :} |\n\t/if left=angle right=maxanglehit rule=gt {: /setvar key=ishit false :} |\n\t/if left=ishit right=false rule=eq {: /break :} |\n\t\n\t/pass enemy{{getvar::i}}smoke |\n\t/if left={{pipe}} right=hidden rule=eq {:\n\t  /setvar key=\"enemy{{getvar::i}}smoke\" visible |\n\t  /setvar key=\"enemy{{getvar::i}}speed\" 0 |\n\t  /addvar key=enemyremaining -1 |\n\t  /addvar key=hitsinarow 1 |\n\t  /echo Nice shot!\n\t:} |\n\t\n\t/if left=hitsinarow right=1 rule=gt {: /setvar key=log {{getvar::log}}{{newline}}- With her luck and skill, {{user}}-chan took out {{getvar::hitsinarow}} tanks in a row with a single shot.\n- Crewmates praise {{user}}-chan.\n- This makes Miki wet her panties.\n- Emi hugs {{user}}-chan in excitement while fondling her boobs and stroking her thighs.\n- Ayame blushes. She keeps stealing glances. :} |\n\t\n\t/if left=enemyremaining right=0 rule=lte {: /run teamneko.winbattle :}\n:} |\n\n\n/let validateaiminput {:\n\t/setvar key=validaiminput true |\n\t/setvar key=toreplace {{noop}} |\n\t/setvar key=regexflags gi |\n\t\n\t/setvar key=regex [^a-z\\d-] |\n\t/regex name=regexreplace {{getvar::tempangle}} |\n\t/setvar key=tempangle |\n\t\n\t/if left=tempangle right=surrender rule=eq {:\n\t  /setvar key=angle 0 | /setvar key=hp 0\n\t:} |\n\t\n\t/if left=chances right=0 rule=lte {: /run teamneko.rolltakedmg :} |\n\t\n\t/if left=hp right=0 rule=lte {:\n\t  /echo severity=error Your team is eliminated. Game over. |\n\t  /setvar key=looping false |\n\t  /run teamneko.gameover |\n\t  /break\n\t:} |\n\t\n\t/if left=tempangle right=fire rule=eq {:\n\t  /setvar key=enemyprocess hitenemy |\n\t  /setvar key=hitsinarow 0 |\n\t  /run scanenemies\n\t:} |\n\t\n\t/setvar key=regex [^\\d-] |\n\t/regex name=regexreplace {{getvar::tempangle}} |\n\t/setvar key=tempangle |\n\t/setvar key=varname tempangle |\n\t/run creamsan.isvardefined |\n\t/if left={{pipe}} right=false rule=eq {: /setvar key=validaiminput false :} |\n\t\n\t/if left=validaiminput right=true rule=eq {: /setvar key=angle {{getvar::tempangle}} :} |\n\t\n\t/addvar key=chances -1 |\n\t/max 0 chances | /setvar key=chances |\n\t\n\t/setvar key=enemyprocess moveenemy |\n\t/run scanenemies\n:} |\n\n\n/setvar key=looping true |\n/setvar key=tempangle 0 |\n/setvar key=bg {{random: https://c.tenor.com/0e6lbNV-AEYAAAAd/tenor.gif,\nhttps://opengameart.org/sites/default/files/backgrounddetailed1.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed2.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed3.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed5.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed6.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed7.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed8.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed1.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed2.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed3.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed5.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed6.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed7.png,\nhttps://opengameart.org/sites/default/files/backgrounddetailed8.png}} |\n\n\n/while left=looping right=true rule=eq {:\n\t/run teamneko.gethpdisp |\n\n\t/input <div style='display: flex; gap: 3px; flex-direction: column; justify-content: center; padding: 5px'>\n\t<style>\n\t.mapscreen {max-width: {{getvar::mapw}}px;\n\theight: {{getvar::maph}}px;\n\tborder: 1px solid green;\n\tposition: relative;\n\toverflow: hidden;\n\tbackground-image: url('{{getvar::bg}}');\n\tbackground-position: bottom\n\t}\n\t.aimline {border-right: 2px solid red;\n\twidth: 2px;\n\theight: {{getvar::line}}px;\n\ttransform-origin: 50% 100%;\n\tposition: absolute;\n\tleft: 50%;\n\ttransform: rotate({{getvar::angle}}deg) scaleY({{getvar::linescale}})\n\t}\n\t.tank {box-shadow: 10px 5px 10px 2px rgba(0, 0, 0, 0.5)\n\t}\n\t.playertank {transform-origin: {{getvar::tank1xoffset}}px {{getvar::tank1yoffset}}px;\n\ttransform: translateX(-{{getvar::tank1xoffset}}px) translateY(-{{getvar::tank1yoffset}}px) scale(0.5)\n\t}\n\t.playergun {transform-origin: {{getvar::tank1gunxoffset}}px {{getvar::tank1gunyoffset}}px;\n\ttransform: translateX(-{{getvar::tank1gunxoffset}}px) translateY(-{{getvar::tank1gunyoffset}}px) scale(0.6) rotate({{getvar::angle}}deg)\n\t}\n\t.playerpos {position: absolute;\n\ttop: 99.5%;\n\tleft: 50%\n\t}\n\t\n\t.enemytank1 {transform-origin: {{getvar::tank1xoffset}}px {{getvar::tank1yoffset}}px;\n\ttransform: translateX(-{{getvar::tank1xoffset}}px) translateY(-{{getvar::tank1yoffset}}px) scale(0.5) rotate(90deg);\n\tposition: absolute\n\t}\n\t.enemygun1 {transform-origin: {{getvar::tank1gunxoffset}}px {{getvar::tank1gunyoffset}}px;\n\ttransform: translateX(-{{getvar::tank1gunxoffset}}px) translateY(-{{getvar::tank1gunyoffset}}px) scale(0.5) rotate(180deg);\n\tposition: absolute\n\t}\n\t.enemy1 {position: absolute;\n\ttop: 100%;\n\tleft: 50%;\n\ttransform: rotate({{getvar::enemy1currangle}}deg) translateY(-{{getvar::enemy1dist}}px);\n\tvisibility: {{getvar::enemy1tank}}\n\t}\n\t.tank1smoke {transform-origin: {{getvar::tanksmokexoffset}}px {{getvar::tanksmokeyoffset}}px;\n\ttransform: translateX(-{{getvar::tanksmokexoffset}}px) translateY(-{{getvar::tanksmokeyoffset}}px) scaleX(0.4) scaleY(0.3) rotate(calc(-1 * {{getvar::enemy1currangle}}deg));\n\tposition: absolute;\n\tvisibility: {{getvar::enemy1smoke}}\n\t}\n\t\n\t.enemytank2 {transform-origin: {{getvar::tank2xoffset}}px {{getvar::tank2yoffset}}px;\n\ttransform: translateX(-{{getvar::tank2xoffset}}px) translateY(-{{getvar::tank2yoffset}}px) scale(0.5) rotate(90deg);\n\tposition: absolute\n\t}\n\t.enemygun2 {transform-origin: {{getvar::tank2gunxoffset}}px {{getvar::tank2gunyoffset}}px;\n\ttransform: translateX(-{{getvar::tank2gunxoffset}}px) translateY(-{{getvar::tank2gunyoffset}}px) scale(0.5) rotate(180deg);\n\tposition: absolute\n\t}\n\t.enemy2 {position: absolute;\n\ttop: 100%;\n\tleft: 50%;\n\ttransform: rotate({{getvar::enemy2currangle}}deg) translateY(-{{getvar::enemy2dist}}px);\n\tvisibility: {{getvar::enemy2tank}}\n\t}\n\t.tank2smoke {transform-origin: {{getvar::tanksmokexoffset}}px {{getvar::tanksmokeyoffset}}px;\n\ttransform: translateX(-{{getvar::tanksmokexoffset}}px) translateY(-{{getvar::tanksmokeyoffset}}px) scaleX(0.4) scaleY(0.3) rotate(calc(-1 * {{getvar::enemy2currangle}}deg));\n\tposition: absolute;\n\tvisibility: {{getvar::enemy2smoke}}\n\t}\n\t\n\t.enemytank3 {transform-origin: {{getvar::tank3xoffset}}px {{getvar::tank3yoffset}}px;\n\ttransform: translateX(-{{getvar::tank3xoffset}}px) translateY(-{{getvar::tank3yoffset}}px) scale(0.5) rotate(90deg);\n\tposition: absolute\n\t}\n\t.enemygun3 {transform-origin: {{getvar::tank3gunxoffset}}px {{getvar::tank3gunyoffset}}px;\n\ttransform: translateX(-{{getvar::tank3gunxoffset}}px) translateY(-{{getvar::tank3gunyoffset}}px) scale(0.5) rotate(180deg);\n\tposition: absolute\n\t}\n\t.enemy3 {position: absolute;\n\ttop: 100%;\n\tleft: 50%;\n\ttransform: rotate({{getvar::enemy3currangle}}deg) translateY(-{{getvar::enemy3dist}}px);\n\tvisibility: {{getvar::enemy3tank}}\n\t}\n\t.tank3smoke {transform-origin: {{getvar::tanksmokexoffset}}px {{getvar::tanksmokeyoffset}}px;\n\ttransform: translateX(-{{getvar::tanksmokexoffset}}px) translateY(-{{getvar::tanksmokeyoffset}}px) scaleX(0.4) scaleY(0.3) rotate(calc(-1 * {{getvar::enemy3currangle}}deg));\n\tposition: absolute;\n\tvisibility: {{getvar::enemy3smoke}}\n\t}\n\t\n\t.enemytank4 {transform-origin: {{getvar::tank4xoffset}}px {{getvar::tank4yoffset}}px;\n\ttransform: translateX(-{{getvar::tank4xoffset}}px) translateY(-{{getvar::tank4yoffset}}px) scale(0.5) rotate(90deg);\n\tposition: absolute\n\t}\n\t.enemygun4 {transform-origin: {{getvar::tank4gunxoffset}}px {{getvar::tank4gunyoffset}}px;\n\ttransform: translateX(-{{getvar::tank4gunxoffset}}px) translateY(-{{getvar::tank4gunyoffset}}px) scale(0.5) rotate(180deg);\n\tposition: absolute\n\t}\n\t.enemy4 {position: absolute;\n\ttop: 100%;\n\tleft: 50%;\n\ttransform: rotate({{getvar::enemy4currangle}}deg) translateY(-{{getvar::enemy4dist}}px);\n\tvisibility: {{getvar::enemy4tank}}\n\t}\n\t.tank4smoke {transform-origin: {{getvar::tanksmokexoffset}}px {{getvar::tanksmokeyoffset}}px;\n\ttransform: translateX(-{{getvar::tanksmokexoffset}}px) translateY(-{{getvar::tanksmokeyoffset}}px) scaleX(0.4) scaleY(0.3) rotate(calc(-1 * {{getvar::enemy4currangle}}deg));\n\tposition: absolute;\n\tvisibility: {{getvar::enemy4smoke}}\n\t}\n\t\n\t.info {padding: 3px;\n\ttext-align: left\n\t}\n\t.instruct {width: 70%;\n\tfont-size: 10px;\n\tborder: 1px solid green\n\t}\n\t.hud {width: 30%;\n\tborder: 1px solid red\n\t}\n\t</style>\n\t<div class='mapscreen'>\n\t\n\t<div class='aimline'></div>\n\t\n\t<img class='tank playertank playerpos' src='{{getvar::tank1}}' alt='Img loading failed :('>\n\t<img class='playergun playerpos' src='{{getvar::tank1gun}}' alt='Img loading failed :('>\n\t\n\t<div class='enemy1'>\n\t<img class='tank enemytank1' src='{{getvar::tank1}}' alt='Img loading failed :('>\n\t<img class='enemygun1' src='{{getvar::tank1gun}}' alt='Img loading failed :('>\n\t<img class='tank1smoke' src='{{getvar::tanksmoke}}' alt='Img loading failed :('>\n\t</div>\n\t\n\t<div class='enemy2'>\n\t<img class='tank enemytank2' src='{{getvar::tank2}}' alt='Img loading failed :('>\n\t<img class='enemygun2' src='{{getvar::tank2gun}}' alt='Img loading failed :('>\n\t<img class='tank2smoke' src='{{getvar::tanksmoke}}' alt='Img loading failed :('>\n\t</div>\n\t\n\t<div class='enemy3'>\n\t<img class='tank enemytank3' src='{{getvar::tank3}}' alt='Img loading failed :('>\n\t<img class='enemygun3' src='{{getvar::tank3gun}}' alt='Img loading failed :('>\n\t<img class='tank3smoke' src='{{getvar::tanksmoke}}' alt='Img loading failed :('>\n\t</div>\n\t\n\t<div class='enemy4'>\n\t<img class='tank enemytank4' src='{{getvar::tank4}}' alt='Img loading failed :('>\n\t<img class='enemygun4' src='{{getvar::tank4gun}}' alt='Img loading failed :('>\n\t<img class='tank4smoke' src='{{getvar::tanksmoke}}' alt='Img loading failed :('>\n\t</div>\n\t</div>\n\t\n\t<div style='display:flex; gap: 3px'>\n\t<div class='info instruct'>\n\tEnter the <b>angle</b> to aim. (0 means aim straight, negative values aim left, positive values aim right)<br>\n\tOnce you have targeted an enemy, enter <b>fire</b> to shoot.<br>\n\tEnter <font color=red><b>surrender</b></font> to lose and end the game.\n\t</div>\n\t<div class='info hud'>\n\tCurrent angle: {{getvar::angle}}°<br>\n\tHP: {{getvar::hpdisp}}<br>\n\tFree turns: {{getvar::chances}}\n\t</div>\n\t</div>\n\t</div> |\n\t\n\t/setvar key=tempangle |\n\t/run validateaiminput\n:}","contextList":[],"preventAutoExecute":true,"isHidden":true,"executeOnStartup":false,"executeOnUser":false,"executeOnAi":false,"executeOnChatChange":false,"executeOnGroupMemberDraft":false,"executeOnNewChat":false,"automationId":""},{"id":17,"showLabel":false,"label":"gethpdisp","title":"","message":"/setvar key=hpdisp {{noop}} |\n/times {{getvar::hp}} {: /addvar key=hpdisp 🛡️ :}","contextList":[],"preventAutoExecute":true,"isHidden":true,"executeOnStartup":false,"executeOnUser":false,"executeOnAi":false,"executeOnChatChange":false,"executeOnGroupMemberDraft":false,"executeOnNewChat":false,"automationId":""},{"id":25,"showLabel":false,"label":"rolltakedmg","title":"","message":"/pass {{roll: d3}} |\n/if left={{pipe}} right=2 rule=gte {:\n  /addvar key=hp -1 | /max 0 hp |\n  /setvar key=hp |\n  /setvar key=log {{getvar::log}}{{newline}}- The crew's tank has taken damage during the battle.\n- Miki is angry and wants to shoot more at defeated enemy tanks.\n- Emi pretends to be scared and hugs {{user}}-chan, but grabs her boobs.\n- Ayame continues to drive, but blushes and steals glances. |\n  /echo severity=warning You have taken damage.\n:}","contextList":[],"preventAutoExecute":true,"isHidden":true,"executeOnStartup":false,"executeOnUser":false,"executeOnAi":false,"executeOnChatChange":false,"executeOnGroupMemberDraft":false,"executeOnNewChat":false,"automationId":""},{"id":27,"showLabel":false,"label":"gameover","title":"","message":"/popup <div>\n<img style='width: 400px' src='https://files.catbox.moe/iryqpn.jpeg' alt='Img loading failed :('>\n</div> |\n/setvar key=jbout Game over. Their tank has been disabled by their opponent. They are eliminated from the match.","contextList":[],"preventAutoExecute":true,"isHidden":true,"executeOnStartup":false,"executeOnUser":false,"executeOnAi":false,"executeOnChatChange":false,"executeOnGroupMemberDraft":false,"executeOnNewChat":false,"automationId":""},{"id":29,"showLabel":false,"label":"winbattle","title":"","message":"/setvar key=looping false |\n/setvar key=jbout The team won the battle. They have defeated {{getvar::enemycount}} enemy tank(s). But they still have a long way to go to reunite with the main group.\n\n{{getvar::log}} |\n/echo severity=success You've won the battle. |\n/if left=lvl right=8 rule=gte {: /run teamneko.showendingpopup :}","contextList":[],"preventAutoExecute":true,"isHidden":true,"executeOnStartup":false,"executeOnUser":false,"executeOnAi":false,"executeOnChatChange":false,"executeOnGroupMemberDraft":false,"executeOnNewChat":false,"automationId":""},{"id":31,"showLabel":false,"label":"showendingpopup","title":"","message":"/popup <h1>Congratulations</h1>\n<font color=red><img style='width: 400px' src='https://files.catbox.moe/gg7nex.jpeg' alt='Image loading failed :('></font><br><br>\n<hr><br><br>\nThanks for checking out my card. If you've made it this far, it means that the script is working as intended, I really hope so. If you encountered any problems, please let me know.<br>\nFrom this point on you should use the normal send button on the right instead of the QR send button.<br>\n<hr><br><br> |\n/setvar key=jbout The crew survived and managed to rejoin with the main squad. It seems that they also wiped out the opposing teams, so they won the match.\n\n{{getvar::log}}","contextList":[],"preventAutoExecute":true,"isHidden":true,"executeOnStartup":false,"executeOnUser":false,"executeOnAi":false,"executeOnChatChange":false,"executeOnGroupMemberDraft":false,"executeOnNewChat":false,"automationId":""},{"id":37,"showLabel":false,"label":"detectencounter","title":"","message":"/re-exec find=/(?<=```\\s*)[\\S\\s]+?(?=\\s*```)/i {{lastMessage}} | /setvar key=extracted |\n/getvar index=0 extracted | /setvar key=extracted | /getvar index=0 extracted |\n/if left={{pipe}} right=battle rule=in {: /setvar key=encounter true :}","contextList":[],"preventAutoExecute":true,"isHidden":true,"executeOnStartup":false,"executeOnUser":false,"executeOnAi":false,"executeOnChatChange":false,"executeOnGroupMemberDraft":false,"executeOnNewChat":false,"automationId":""},{"id":40,"showLabel":false,"label":"-- detectencounter","title":"","message":"//legacy - this one uses the regex script |\n\n/setvar key=tomsgprocess {{lastMessage}} |\n/setvar key=startregex ```\\s* |\n/setvar key=endregex \\s*``` |\n/run creamsan.regextract |\n/if left={{pipe}} right=battle rule=in {: /setvar key=encounter true :}","contextList":[],"preventAutoExecute":true,"isHidden":true,"executeOnStartup":false,"executeOnUser":false,"executeOnAi":false,"executeOnChatChange":false,"executeOnGroupMemberDraft":false,"executeOnNewChat":false,"automationId":""}],"idIndex":42}